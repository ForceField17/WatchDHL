cat snv_FL_somatic_Mut.specific.txt | awk '($1!="P1" && $1!="P7")'   >  FL_somatic_Mut.specific.txt
cat ../remove_FFPE_artifacts/P1_FL.txt | awk -F"\t"  '{print $1"\t"$2"\t"$3"\t"$4"\t"$5"\t"$6"\t"$7"\t"$8"\t"$9"\t"$10"\t"$11"\t"$12"\t"$13"\t"$14"\t"$15"\t"$16"\t"$17"\t"$18"\t"$19"\t"$20"\t"$21"\t"$22"\t"$23"\t"$24"\t"$25"\t"$26"\t"$27"\t"$28"\t"$29"\t"$30"\t"$31"\t"$32"\t"$33"\t"$34"\t"$35"\t"$36"\t"$37"\t"$38"\t"$39"\t"$40"\t"$41"\t"$42"\t"$43"\t"$44"\t"$45"\t"$46"\t"$47"\t"$48"\t"$49"\t"$50"\t"$51"\t"$52"\t"$53"\t"$54"\t"$55"\t"$56"\t"$57"\t"$58"\t"$59"\t"$60"\t"$61"\t"$62"\t"$63"\t"$64"\t"$65"\t"$66"\t"$67"\t"$68"\t"$69"\t"$70"\t"$71"\t"$72"\t"$73"\t"$74"\t"$75"\t"$76"\t"$77"\t"$78"\t"$79"\t"$80"\t"$81"\t"$82"\t"$83"\t"$84"\t"$85"\t"$86"\t"$87"\t"$88"\t"$89"\t"$90"\t"$91"\t"$92"\t"$93"\t"$94"\t"$95"\t"$96"\t"$97"\t"$98"\t"$99"\t"$100"\t"$101"\t"$102"\t"$103"\t"$104"\t"$105"\t"$106"\t"$107"\t"$108"\t"$109"\t"$110"\t"$111"\t"$112"\t"$113}' >> FL_somatic_Mut.specific.txt
cat ../remove_FFPE_artifacts/P7_FL.txt | awk -F"\t"  '{print $1"\t"$2"\t"$3"\t"$4"\t"$5"\t"$6"\t"$7"\t"$8"\t"$9"\t"$10"\t"$11"\t"$12"\t"$13"\t"$14"\t"$15"\t"$16"\t"$17"\t"$18"\t"$19"\t"$20"\t"$21"\t"$22"\t"$23"\t"$24"\t"$25"\t"$26"\t"$27"\t"$28"\t"$29"\t"$30"\t"$31"\t"$32"\t"$33"\t"$34"\t"$35"\t"$36"\t"$37"\t"$38"\t"$39"\t"$40"\t"$41"\t"$42"\t"$43"\t"$44"\t"$45"\t"$46"\t"$47"\t"$48"\t"$49"\t"$50"\t"$51"\t"$52"\t"$53"\t"$54"\t"$55"\t"$56"\t"$57"\t"$58"\t"$59"\t"$60"\t"$61"\t"$62"\t"$63"\t"$64"\t"$65"\t"$66"\t"$67"\t"$68"\t"$69"\t"$70"\t"$71"\t"$72"\t"$73"\t"$74"\t"$75"\t"$76"\t"$77"\t"$78"\t"$79"\t"$80"\t"$81"\t"$82"\t"$83"\t"$84"\t"$85"\t"$86"\t"$87"\t"$88"\t"$89"\t"$90"\t"$91"\t"$92"\t"$93"\t"$94"\t"$95"\t"$96"\t"$97"\t"$98"\t"$99"\t"$100"\t"$101"\t"$102"\t"$103"\t"$104"\t"$105"\t"$106"\t"$107"\t"$108"\t"$109"\t"$110"\t"$111"\t"$112"\t"$113}' >> FL_somatic_Mut.specific.txt

tail -n+2 indel_FL_somatic_Mut.specific.txt  | awk -F"\t" '($1!="P8")' | awk -F"\t"  '{print $1"\t"$2"\t"$3"\t"$4"\t"$5"\t"$6"\t"$7"\t"$8"\t"$9"\t"$10"\t"$11"\t"$12"\t"$13"\t"$14"\t"$15"\t"$16"\t"$17"\t"$18"\t"$19"\t"$20"\t"$21"\t"$22"\t"$23"\t"$24"\t"$25"\t"$26"\t"$27"\t"$28"\t"$29"\t"$30"\t"$31"\t"$32"\t"$33"\t"$34"\t"$35"\t"$36"\t"$37"\t"$38"\t"$39"\t"$40"\t"$41"\t"$42"\t"$43"\t"$44"\t"$45"\t"$46"\t"$47"\t"$48"\t"$49"\t"int($109/($108+$109+0.01)*100+0.5)"\t"$51"\t"int($113/($112+$113+0.01)*100+0.5)"\t"$53"\t"$54"\t"$55"\t"$56"\t"$57"\t"$58"\t"$59"\t"$60"\t"$61"\t"$62"\t"$63"\t"$64"\t"$65"\t"$66"\t"$67"\t"$68"\t"$69"\t"$70"\t"$108"\t"$109"\t"$73"\t"$74"\t"$75"\t"$76"\t"$77"\t"$78"\t"$79"\t"$80"\t"$81"\t"$82"\t"$83"\t"$84"\t"$85"\t"$86"\t"$87"\t"$88"\t"$112"\t"$113"\t"$91"\t"$92"\t"$93"\t"$94"\t"$95"\t"$96"\t"$97"\t"$98"\t"$99"\t"$100"\t"$101"\t"$102"\t"$103"\t"$104"\t"$105"\t"$106"\t"$107"\t"$108"\t"$109"\t"$110"\t"$111"\t"$112"\t"$113}' >>  FL_somatic_Mut.specific.txt

tail -n+2 indel_FL_somatic_Mut.specific.txt  | awk -F"\t" '($1=="P8")' | awk -F"\t"  '{print $1"\t"$2"\t"$3"\t"$4"\t"$5"\t"$6"\t"$7"\t"$8"\t"$9"\t"$10"\t"$11"\t"$12"\t"$13"\t"$14"\t"$15"\t"$16"\t"$17"\t"$18"\t"$19"\t"$20"\t"$21"\t"$22"\t"$23"\t"$24"\t"$25"\t"$26"\t"$27"\t"$28"\t"$29"\t"$30"\t"$31"\t"$32"\t"$33"\t"$34"\t"$35"\t"$36"\t"$37"\t"$38"\t"$39"\t"$40"\t"$41"\t"$42"\t"$43"\t"$44"\t"$45"\t"$46"\t"$47"\t"$48"\t"$49"\t"int($109/($108+$109+0.01)*100+0.5)"\t"int($111/($110+$111+0.01)*100+0.5)"\t"int($113/($112+$113+0.01)*100+0.5)"\t"$53"\t"$54"\t"$55"\t"$56"\t"$57"\t"$58"\t"$59"\t"$60"\t"$61"\t"$62"\t"$63"\t"$64"\t"$65"\t"$66"\t"$67"\t"$68"\t"$69"\t"$70"\t"$108"\t"$109"\t"$73"\t"$74"\t"$75"\t"$76"\t"$77"\t"$78"\t"$79"\t"$110"\t"$111"\t"$82"\t"$83"\t"$84"\t"$85"\t"$86"\t"$87"\t"$88"\t"$112"\t"$113"\t"$91"\t"$92"\t"$93"\t"$94"\t"$95"\t"$96"\t"$97"\t"$98"\t"$99"\t"$100"\t"$101"\t"$102"\t"$103"\t"$104"\t"$105"\t"$106"\t"$107"\t"$108"\t"$109"\t"$110"\t"$111"\t"$112"\t"$113}' >>  FL_somatic_Mut.specific.txt



cat snv_DHL_somatic_Mut.specific.txt | awk '($1!="P1" && $1!="P7")'      > DHL_somatic_Mut.specific.txt
cat ../remove_FFPE_artifacts/P1_DHL.txt | awk -F"\t"  '{print $1"\t"$2"\t"$3"\t"$4"\t"$5"\t"$6"\t"$7"\t"$8"\t"$9"\t"$10"\t"$11"\t"$12"\t"$13"\t"$14"\t"$15"\t"$16"\t"$17"\t"$18"\t"$19"\t"$20"\t"$21"\t"$22"\t"$23"\t"$24"\t"$25"\t"$26"\t"$27"\t"$28"\t"$29"\t"$30"\t"$31"\t"$32"\t"$33"\t"$34"\t"$35"\t"$36"\t"$37"\t"$38"\t"$39"\t"$40"\t"$41"\t"$42"\t"$43"\t"$44"\t"$45"\t"$46"\t"$47"\t"$48"\t"$49"\t"$50"\t"$51"\t"$52"\t"$53"\t"$54"\t"$55"\t"$56"\t"$57"\t"$58"\t"$59"\t"$60"\t"$61"\t"$62"\t"$63"\t"$64"\t"$65"\t"$66"\t"$67"\t"$68"\t"$69"\t"$70"\t"$71"\t"$72"\t"$73"\t"$74"\t"$75"\t"$76"\t"$77"\t"$78"\t"$79"\t"$80"\t"$81"\t"$82"\t"$83"\t"$84"\t"$85"\t"$86"\t"$87"\t"$88"\t"$89"\t"$90"\t"$91"\t"$92"\t"$93"\t"$94"\t"$95"\t"$96"\t"$97"\t"$98"\t"$99"\t"$100"\t"$101"\t"$102"\t"$103"\t"$104"\t"$105"\t"$106"\t"$107"\t"$108"\t"$109"\t"$110"\t"$111"\t"$112"\t"$113}' >> DHL_somatic_Mut.specific.txt
cat ../remove_FFPE_artifacts/P7_DHL.txt | awk -F"\t"  '{print $1"\t"$2"\t"$3"\t"$4"\t"$5"\t"$6"\t"$7"\t"$8"\t"$9"\t"$10"\t"$11"\t"$12"\t"$13"\t"$14"\t"$15"\t"$16"\t"$17"\t"$18"\t"$19"\t"$20"\t"$21"\t"$22"\t"$23"\t"$24"\t"$25"\t"$26"\t"$27"\t"$28"\t"$29"\t"$30"\t"$31"\t"$32"\t"$33"\t"$34"\t"$35"\t"$36"\t"$37"\t"$38"\t"$39"\t"$40"\t"$41"\t"$42"\t"$43"\t"$44"\t"$45"\t"$46"\t"$47"\t"$48"\t"$49"\t"$50"\t"$51"\t"$52"\t"$53"\t"$54"\t"$55"\t"$56"\t"$57"\t"$58"\t"$59"\t"$60"\t"$61"\t"$62"\t"$63"\t"$64"\t"$65"\t"$66"\t"$67"\t"$68"\t"$69"\t"$70"\t"$71"\t"$72"\t"$73"\t"$74"\t"$75"\t"$76"\t"$77"\t"$78"\t"$79"\t"$80"\t"$81"\t"$82"\t"$83"\t"$84"\t"$85"\t"$86"\t"$87"\t"$88"\t"$89"\t"$90"\t"$91"\t"$92"\t"$93"\t"$94"\t"$95"\t"$96"\t"$97"\t"$98"\t"$99"\t"$100"\t"$101"\t"$102"\t"$103"\t"$104"\t"$105"\t"$106"\t"$107"\t"$108"\t"$109"\t"$110"\t"$111"\t"$112"\t"$113}' >> DHL_somatic_Mut.specific.txt


tail -n+2 indel_DHL_somatic_Mut.specific.txt  | awk -F"\t" '($1!="P8")' | awk -F"\t"  '{print $1"\t"$2"\t"$3"\t"$4"\t"$5"\t"$6"\t"$7"\t"$8"\t"$9"\t"$10"\t"$11"\t"$12"\t"$13"\t"$14"\t"$15"\t"$16"\t"$17"\t"$18"\t"$19"\t"$20"\t"$21"\t"$22"\t"$23"\t"$24"\t"$25"\t"$26"\t"$27"\t"$28"\t"$29"\t"$30"\t"$31"\t"$32"\t"$33"\t"$34"\t"$35"\t"$36"\t"$37"\t"$38"\t"$39"\t"$40"\t"$41"\t"$42"\t"$43"\t"$44"\t"$45"\t"$46"\t"$47"\t"$48"\t"$49"\t"int($109/($108+$109+0.01)*100+0.5)"\t"$51"\t"int($113/($112+$113+0.01)*100+0.5)"\t"$53"\t"$54"\t"$55"\t"$56"\t"$57"\t"$58"\t"$59"\t"$60"\t"$61"\t"$62"\t"$63"\t"$64"\t"$65"\t"$66"\t"$67"\t"$68"\t"$69"\t"$70"\t"$108"\t"$109"\t"$73"\t"$74"\t"$75"\t"$76"\t"$77"\t"$78"\t"$79"\t"$80"\t"$81"\t"$82"\t"$83"\t"$84"\t"$85"\t"$86"\t"$87"\t"$88"\t"$112"\t"$113"\t"$91"\t"$92"\t"$93"\t"$94"\t"$95"\t"$96"\t"$97"\t"$98"\t"$99"\t"$100"\t"$101"\t"$102"\t"$103"\t"$104"\t"$105"\t"$106"\t"$107"\t"$108"\t"$109"\t"$110"\t"$111"\t"$112"\t"$113}' >>  DHL_somatic_Mut.specific.txt

tail -n+2 indel_DHL_somatic_Mut.specific.txt  | awk -F"\t" '($1=="P8")' | awk -F"\t"  '{print $1"\t"$2"\t"$3"\t"$4"\t"$5"\t"$6"\t"$7"\t"$8"\t"$9"\t"$10"\t"$11"\t"$12"\t"$13"\t"$14"\t"$15"\t"$16"\t"$17"\t"$18"\t"$19"\t"$20"\t"$21"\t"$22"\t"$23"\t"$24"\t"$25"\t"$26"\t"$27"\t"$28"\t"$29"\t"$30"\t"$31"\t"$32"\t"$33"\t"$34"\t"$35"\t"$36"\t"$37"\t"$38"\t"$39"\t"$40"\t"$41"\t"$42"\t"$43"\t"$44"\t"$45"\t"$46"\t"$47"\t"$48"\t"$49"\t"int($109/($108+$109+0.01)*100+0.5)"\t"int($111/($110+$111+0.01)*100+0.5)"\t"int($113/($112+$113+0.01)*100+0.5)"\t"$53"\t"$54"\t"$55"\t"$56"\t"$57"\t"$58"\t"$59"\t"$60"\t"$61"\t"$62"\t"$63"\t"$64"\t"$65"\t"$66"\t"$67"\t"$68"\t"$69"\t"$70"\t"$108"\t"$109"\t"$73"\t"$74"\t"$75"\t"$76"\t"$77"\t"$78"\t"$79"\t"$110"\t"$111"\t"$82"\t"$83"\t"$84"\t"$85"\t"$86"\t"$87"\t"$88"\t"$112"\t"$113"\t"$91"\t"$92"\t"$93"\t"$94"\t"$95"\t"$96"\t"$97"\t"$98"\t"$99"\t"$100"\t"$101"\t"$102"\t"$103"\t"$104"\t"$105"\t"$106"\t"$107"\t"$108"\t"$109"\t"$110"\t"$111"\t"$112"\t"$113}' >>  DHL_somatic_Mut.specific.txt



head -n1 DHL_somatic_Mut.specific.txt > xx
grep -v "CaseID" DHL_somatic_Mut.specific.txt >> xx
mv xx DHL_somatic_Mut.specific.txt

head -n1 FL_somatic_Mut.specific.txt > xx
grep -v "CaseID" FL_somatic_Mut.specific.txt >> xx
mv xx FL_somatic_Mut.specific.txt

cut -f 1,2,3,4,5,52,105 DHL_somatic_Mut.specific.txt > DHL.specific.bed

cat FL_somatic_Mut.specific.txt | awk -F"\t" '(    NR==1 || $1!="P8" || ($1=="P8" && $105=="SNV" && $109>=4 && $50>=10) || ($1=="P8" &&  $105!="SNV" && $109>=5 && $50>=10 ))'      | cut -f 1,2,3,4,5,50,105 | sed s/P8/P8.a/g  > FL.specific.bed
cat FL_somatic_Mut.specific.txt | awk -F"\t" '($1=="P8")' | awk -F"\t"  '( $111>=5 && $51>=20 )'      | cut -f 1,2,3,4,5,51,105 | sed s/P8/P8.b/g >> FL.specific.bed


head -n1 DHL.specific.bed > DHL.specific.seg
head -n1 FL.specific.bed > FL.specific.seg
tail -n+2 DHL.specific.bed | awk -F"\t" '{if($7=="SNV"){print $1".DHL\t"$2"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6"\t"$7}else{print $1".DHL\t"$2"\t"$3"\t"$3+length($4)+length($5)-2"\t"$4"\t"$5"\t"$6"\t"$7}}' | sort >> DHL.specific.seg
tail -n+2 FL.specific.bed  | awk -F"\t" '{if($7=="SNV"){print  $1".FL\t"$2"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6"\t"$7}else{print  $1".FL\t"$2"\t"$3"\t"$3+length($4)+length($5)-2"\t"$4"\t"$5"\t"$6"\t"$7}}' | sort >> FL.specific.seg

head -n1 DHL.specific.bed > DHL.25.seg
head -n1 FL.specific.bed > FL.25.seg
tail -n+2 DHL.specific.bed | awk -F"\t" '($6>=25)' | awk -F"\t" '{if($7=="SNV"){print $1".DHL\t"$2"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6"\t"$7}else{print $1".DHL\t"$2"\t"$3"\t"$3+length($4)+length($5)-2"\t"$4"\t"$5"\t"$6"\t"$7}}' | sort >> DHL.25.seg
tail -n+2 FL.specific.bed  | awk -F"\t" '($6>=25)' | awk -F"\t" '{if($7=="SNV"){print  $1".FL\t"$2"\t"$3-1"\t"$3"\t"$4"\t"$5"\t"$6"\t"$7}else{print  $1".FL\t"$2"\t"$3"\t"$3+length($4)+length($5)-2"\t"$4"\t"$5"\t"$6"\t"$7}}' | sort >> FL.25.seg
