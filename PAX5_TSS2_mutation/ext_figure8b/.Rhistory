F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0.1,1,1,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='bottom',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_text(size=12,angle=90,vjust=0.5,hjust=1,face='plain',color='black'),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
figure_1<-rbind(ggplotGrob(F1b.pLot))
ggsave(file="test.pdf", plot=figure_1,bg = 'white', width = 20, height =  14, units = 'cm', dpi = 600)
################3
IDrank <- IDrank[which(IDrank$sample %in% case),]
######
F2a.pLot<-ggplot()+theme_classic()
F2a.pLot<-F2a.pLot+geom_tile(data = IDrank,aes(x=reorder(sample,Xrank),y="Histology",fill=histology),color='black',alpha=0.7,width=1,height=1,size=0.4,stat='identity')
F2a.pLot<-F2a.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(1,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='non',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.3,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F2a.pLot<-F2a.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)+scale_fill_manual(name=NULL,values =c(GCB='#bf812d'))
F2a.pLot
#######
F2b.pLot<-ggplot()+theme_classic()
F2b.pLot<-F2b.pLot+geom_tile(data = IDrank,aes(x=reorder(sample,Xrank),y="ZCCHC7",fill=ZCCHC7_SV),color='black',alpha=1,width=1,height=1,size=0.4,stat='identity')
IDrank_CNV <- IDrank[which(IDrank$ZCCHC7_CNV=="Gain"),]
F2b.pLot<-F2b.pLot+geom_point(data = IDrank_CNV,aes(x=reorder(sample,Xrank),y="ZCCHC7"),shape=24,fill="red",color='black',alpha=1,size=3)
F2b.pLot<-F2b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.3,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F2b.pLot<-F2b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)+scale_fill_manual(name=NULL,values =c(Fusion='#bc80bd',WT="white"))
F2b.pLot
figure_1<-cbind(rbind(ggplotGrob(F2a.pLot),ggplotGrob(F1b.pLot)),size="last")
panels <- figure_1$layout$t[grep("panel", figure_1$layout$name)]
figure_1$heights[panels][1] <- unit(0.7,'null')
figure_1$heights[panels][2] <- unit(12,'null')
#grid.draw(figure_1)
ggsave(file="test_landscape_ZCCHC7_locus.pdf", plot=figure_1,bg = 'white', width = 10, height = 12, units = 'cm', dpi = 600)
tableA <- new_table[which(new_table$Pos >= 37025363 & new_table$Pos <= 37025364),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0.1,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
# pGCT
library(rstudioapi)
# Getting the path of your current open file
current_path = rstudioapi::getActiveDocumentContext()$path
setwd(dirname(current_path ))
print( getwd() )
library(ggplot2)
library(gridExtra)
library(grid)
library(reshape2)
gg_color_hue <- function(n) {
hues = seq(15, 375, length = n + 1)
hcl(h = hues, l = 65, c = 100)[1:n]
}
#,37026456
Morethan2 <- c(37026028,37026029,37026315,37026316,37026678,37026680,37026681,37026705,37026706,37026733,37026734)
rank <- c(1:length(Morethan2))*-1
PosRank <- data.frame(Morethan2,rank)
colnames(PosRank ) <- c("Pos","Yrank")
IDrank <- read.table("IDrank.txt",sep = "\t",header = T)
IDrank <- IDrank[which(IDrank$tissue=="Tumor"),]
Table <- read.table("matrix.txt",sep = "\t",header = T)
Table <- Table[which(Table$Source=="WGS"),]
new_table <- merge(Table,PosRank ,1,1)
#####
case <- unique(new_table$sample)
gene.Matrix <- rep('N',length(case))
for( i in 2:length(Morethan2)){
gene.Matrix <- cbind(gene.Matrix,rep('N',length(case)))
}
for(i in 1:length(case)){
for(j in 1:length(Morethan2)){
temp.P <- Table$sub[which(Table$sample == as.character(case[i]) & Table$Pos == Morethan2[j] )]
if(length(temp.P) == 1){
gene.Matrix[i,j] <- as.character(temp.P)
}
if(length(temp.P) > 1){
gene.Matrix[i,j] <- as.character(temp.P[1])
}
if("Ins" %in% temp.P){
gene.Matrix[i,j] <- "Ins"
}
}
}
colnames(gene.Matrix) <- Morethan2
rownames(gene.Matrix) <- case
background <- melt(gene.Matrix)
colnames(background) <- c("sample","Pos","sub")
new_table <- merge(background,PosRank )
new_table <- merge(new_table ,IDrank )
#######################3
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = new_table,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0.1,1,1,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='bottom',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_text(size=12,angle=90,vjust=0.5,hjust=1,face='plain',color='black'),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
figure_1<-rbind(ggplotGrob(F1b.pLot))
ggsave(file="test.pdf", plot=figure_1,bg = 'white', width = 20, height =  14, units = 'cm', dpi = 600)
################3
IDrank <- IDrank[which(IDrank$sample %in% case),]
######
F2a.pLot<-ggplot()+theme_classic()
F2a.pLot<-F2a.pLot+geom_tile(data = IDrank,aes(x=reorder(sample,Xrank),y="Histology",fill=histology),color='black',alpha=0.7,width=1,height=1,size=0.4,stat='identity')
F2a.pLot<-F2a.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(1,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='non',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.3,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F2a.pLot<-F2a.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)+scale_fill_manual(name=NULL,values =c(GCB='#bf812d'))
F2a.pLot
#######
F2b.pLot<-ggplot()+theme_classic()
F2b.pLot<-F2b.pLot+geom_tile(data = IDrank,aes(x=reorder(sample,Xrank),y="ZCCHC7",fill=ZCCHC7_SV),color='black',alpha=1,width=1,height=1,size=0.4,stat='identity')
IDrank_CNV <- IDrank[which(IDrank$ZCCHC7_CNV=="Gain"),]
F2b.pLot<-F2b.pLot+geom_point(data = IDrank_CNV,aes(x=reorder(sample,Xrank),y="ZCCHC7"),shape=24,fill="red",color='black',alpha=1,size=3)
F2b.pLot<-F2b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.3,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F2b.pLot<-F2b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)+scale_fill_manual(name=NULL,values =c(Fusion='#bc80bd',WT="white"))
F2b.pLot
figure_1<-cbind(rbind(ggplotGrob(F2a.pLot),ggplotGrob(F1b.pLot)),size="last")
panels <- figure_1$layout$t[grep("panel", figure_1$layout$name)]
figure_1$heights[panels][1] <- unit(0.7,'null')
figure_1$heights[panels][2] <- unit(12,'null')
#grid.draw(figure_1)
ggsave(file="test_landscape_ZCCHC7_locus.pdf", plot=figure_1,bg = 'white', width = 10, height = 12, units = 'cm', dpi = 600)
tableA <- new_table[which(new_table$Pos >= 37026028 & new_table$Pos <= 37026029),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0.1,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part1 <- F1b.pLot
tableA <- new_table[which(new_table$Pos >= 37026704 & new_table$Pos <= 37026705),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part2 <- F1b.pLot
tableA <- new_table[which(new_table$Pos >= 37026315 & new_table$Pos <= 37026316),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part3 <- F1b.pLot
tableA <- new_table[which(new_table$Pos >= 37026680 & new_table$Pos <= 37026681),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part4 <- F1b.pLot
tableA <- new_table[which(new_table$Pos >= 37026733 & new_table$Pos <= 37026734),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,1,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_text(size=12,angle=90,vjust=0.5,hjust=1,face='plain',color='black'),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part5 <- F1b.pLot
figure<-cbind(rbind(ggplotGrob(F2a.pLot),ggplotGrob(Part1),ggplotGrob(Part2),ggplotGrob(Part3),ggplotGrob(Part4),ggplotGrob(Part5)),size="last")
panels <- figure$layout$t[grep("panel", figure$layout$name)]
figure$heights[panels][1] <- unit(0.7,'null')
figure$heights[panels][2] <- unit(2,'null')
figure$heights[panels][3] <- unit(2,'null')
figure$heights[panels][4] <- unit(2,'null')
figure$heights[panels][5] <- unit(2,'null')
figure$heights[panels][6] <- unit(2,'null')
#grid.draw(figure_1)
ggsave(file="test_landscape_WGS_supported_TSS2_hotspotMut_in_GCB_tumors.pdf", plot=figure,bg = 'white', width = 9.5, height = 9, units = 'cm', dpi = 600)
# pGCT
library(rstudioapi)
# Getting the path of your current open file
current_path = rstudioapi::getActiveDocumentContext()$path
setwd(dirname(current_path ))
print( getwd() )
library(ggplot2)
library(gridExtra)
library(grid)
library(reshape2)
gg_color_hue <- function(n) {
hues = seq(15, 375, length = n + 1)
hcl(h = hues, l = 65, c = 100)[1:n]
}
#,37026456
Morethan2 <- c(37026028,37026029,37026315,37026316,37026678,37026680,37026681,37026705,37026706,37026733,37026734)
rank <- c(1:length(Morethan2))*-1
PosRank <- data.frame(Morethan2,rank)
colnames(PosRank ) <- c("Pos","Yrank")
IDrank <- read.table("IDrank.txt",sep = "\t",header = T)
IDrank <- IDrank[which(IDrank$tissue=="Tumor"),]
Table <- read.table("matrix.txt",sep = "\t",header = T)
Table <- Table[which(Table$Source=="WGS"),]
new_table <- merge(Table,PosRank ,1,1)
#####
case <- unique(new_table$sample)
gene.Matrix <- rep('N',length(case))
for( i in 2:length(Morethan2)){
gene.Matrix <- cbind(gene.Matrix,rep('N',length(case)))
}
for(i in 1:length(case)){
for(j in 1:length(Morethan2)){
temp.P <- Table$sub[which(Table$sample == as.character(case[i]) & Table$Pos == Morethan2[j] )]
if(length(temp.P) == 1){
gene.Matrix[i,j] <- as.character(temp.P)
}
if(length(temp.P) > 1){
gene.Matrix[i,j] <- as.character(temp.P[1])
}
if("Ins" %in% temp.P){
gene.Matrix[i,j] <- "Ins"
}
}
}
colnames(gene.Matrix) <- Morethan2
rownames(gene.Matrix) <- case
background <- melt(gene.Matrix)
colnames(background) <- c("sample","Pos","sub")
new_table <- merge(background,PosRank )
new_table <- merge(new_table ,IDrank )
#######################3
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = new_table,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0.1,1,1,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='bottom',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_text(size=12,angle=90,vjust=0.5,hjust=1,face='plain',color='black'),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
figure_1<-rbind(ggplotGrob(F1b.pLot))
ggsave(file="test.pdf", plot=figure_1,bg = 'white', width = 20, height =  14, units = 'cm', dpi = 600)
################3
IDrank <- IDrank[which(IDrank$sample %in% case),]
######
F2a.pLot<-ggplot()+theme_classic()
F2a.pLot<-F2a.pLot+geom_tile(data = IDrank,aes(x=reorder(sample,Xrank),y="Histology",fill=histology),color='black',alpha=0.7,width=1,height=1,size=0.4,stat='identity')
F2a.pLot<-F2a.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(1,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='non',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.3,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F2a.pLot<-F2a.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)+scale_fill_manual(name=NULL,values =c(GCB='#bf812d'))
F2a.pLot
#######
F2b.pLot<-ggplot()+theme_classic()
F2b.pLot<-F2b.pLot+geom_tile(data = IDrank,aes(x=reorder(sample,Xrank),y="ZCCHC7",fill=ZCCHC7_SV),color='black',alpha=1,width=1,height=1,size=0.4,stat='identity')
IDrank_CNV <- IDrank[which(IDrank$ZCCHC7_CNV=="Gain"),]
F2b.pLot<-F2b.pLot+geom_point(data = IDrank_CNV,aes(x=reorder(sample,Xrank),y="ZCCHC7"),shape=24,fill="red",color='black',alpha=1,size=3)
F2b.pLot<-F2b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.3,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F2b.pLot<-F2b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)+scale_fill_manual(name=NULL,values =c(Fusion='#bc80bd',WT="white"))
F2b.pLot
figure_1<-cbind(rbind(ggplotGrob(F2a.pLot),ggplotGrob(F1b.pLot)),size="last")
panels <- figure_1$layout$t[grep("panel", figure_1$layout$name)]
figure_1$heights[panels][1] <- unit(0.7,'null')
figure_1$heights[panels][2] <- unit(12,'null')
#grid.draw(figure_1)
ggsave(file="test_landscape_ZCCHC7_locus.pdf", plot=figure_1,bg = 'white', width = 10, height = 12, units = 'cm', dpi = 600)
tableA <- new_table[which(new_table$Pos >= 37026028 & new_table$Pos <= 37026029),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0.1,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part1 <- F1b.pLot
tableA <- new_table[which(new_table$Pos >= 37026705 & new_table$Pos <= 37026706),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part2 <- F1b.pLot
tableA <- new_table[which(new_table$Pos >= 37026315 & new_table$Pos <= 37026316),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part3 <- F1b.pLot
tableA <- new_table[which(new_table$Pos >= 37026680 & new_table$Pos <= 37026681),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part4 <- F1b.pLot
tableA <- new_table[which(new_table$Pos >= 37026733 & new_table$Pos <= 37026734),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,1,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_text(size=12,angle=90,vjust=0.5,hjust=1,face='plain',color='black'),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part5 <- F1b.pLot
figure<-cbind(rbind(ggplotGrob(F2a.pLot),ggplotGrob(Part1),ggplotGrob(Part2),ggplotGrob(Part3),ggplotGrob(Part4),ggplotGrob(Part5)),size="last")
panels <- figure$layout$t[grep("panel", figure$layout$name)]
figure$heights[panels][1] <- unit(0.7,'null')
figure$heights[panels][2] <- unit(2,'null')
figure$heights[panels][3] <- unit(2,'null')
figure$heights[panels][4] <- unit(2,'null')
figure$heights[panels][5] <- unit(2,'null')
figure$heights[panels][6] <- unit(2,'null')
#grid.draw(figure_1)
ggsave(file="test_landscape_WGS_supported_TSS2_hotspotMut_in_GCB_tumors.pdf", plot=figure,bg = 'white', width = 9.5, height = 9, units = 'cm', dpi = 600)
# pGCT
library(rstudioapi)
# Getting the path of your current open file
current_path = rstudioapi::getActiveDocumentContext()$path
setwd(dirname(current_path ))
print( getwd() )
library(ggplot2)
library(gridExtra)
library(grid)
library(reshape2)
gg_color_hue <- function(n) {
hues = seq(15, 375, length = n + 1)
hcl(h = hues, l = 65, c = 100)[1:n]
}
#,37026456
Morethan2 <- c(37026028,37026029,37026315,37026316,37026678,37026680,37026681,37026705,37026706,37026733,37026734)
rank <- c(1:length(Morethan2))*-1
PosRank <- data.frame(Morethan2,rank)
colnames(PosRank ) <- c("Pos","Yrank")
IDrank <- read.table("IDrank.txt",sep = "\t",header = T)
IDrank <- IDrank[which(IDrank$tissue=="Tumor"),]
Table <- read.table("matrix.txt",sep = "\t",header = T)
Table <- Table[which(Table$Source=="WGS"),]
new_table <- merge(Table,PosRank ,1,1)
#####
case <- unique(new_table$sample)
gene.Matrix <- rep('N',length(case))
for( i in 2:length(Morethan2)){
gene.Matrix <- cbind(gene.Matrix,rep('N',length(case)))
}
for(i in 1:length(case)){
for(j in 1:length(Morethan2)){
temp.P <- Table$sub[which(Table$sample == as.character(case[i]) & Table$Pos == Morethan2[j] )]
if(length(temp.P) == 1){
gene.Matrix[i,j] <- as.character(temp.P)
}
if(length(temp.P) > 1){
gene.Matrix[i,j] <- as.character(temp.P[1])
}
if("Ins" %in% temp.P){
gene.Matrix[i,j] <- "Ins"
}
}
}
colnames(gene.Matrix) <- Morethan2
rownames(gene.Matrix) <- case
background <- melt(gene.Matrix)
colnames(background) <- c("sample","Pos","sub")
new_table <- merge(background,PosRank )
new_table <- merge(new_table ,IDrank )
#######################3
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = new_table,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0.1,1,1,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='bottom',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_text(size=12,angle=90,vjust=0.5,hjust=1,face='plain',color='black'),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
figure_1<-rbind(ggplotGrob(F1b.pLot))
ggsave(file="test.pdf", plot=figure_1,bg = 'white', width = 20, height =  14, units = 'cm', dpi = 600)
################3
IDrank <- IDrank[which(IDrank$sample %in% case),]
######
F2a.pLot<-ggplot()+theme_classic()
F2a.pLot<-F2a.pLot+geom_tile(data = IDrank,aes(x=reorder(sample,Xrank),y="Histology",fill=histology),color='black',alpha=0.7,width=1,height=1,size=0.4,stat='identity')
F2a.pLot<-F2a.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(1,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='non',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.3,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F2a.pLot<-F2a.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)+scale_fill_manual(name=NULL,values =c(GCB='#bf812d'))
F2a.pLot
#######
F2b.pLot<-ggplot()+theme_classic()
F2b.pLot<-F2b.pLot+geom_tile(data = IDrank,aes(x=reorder(sample,Xrank),y="ZCCHC7",fill=ZCCHC7_SV),color='black',alpha=1,width=1,height=1,size=0.4,stat='identity')
IDrank_CNV <- IDrank[which(IDrank$ZCCHC7_CNV=="Gain"),]
F2b.pLot<-F2b.pLot+geom_point(data = IDrank_CNV,aes(x=reorder(sample,Xrank),y="ZCCHC7"),shape=24,fill="red",color='black',alpha=1,size=3)
F2b.pLot<-F2b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.3,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F2b.pLot<-F2b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)+scale_fill_manual(name=NULL,values =c(Fusion='#bc80bd',WT="white"))
F2b.pLot
figure_1<-cbind(rbind(ggplotGrob(F2a.pLot),ggplotGrob(F1b.pLot)),size="last")
panels <- figure_1$layout$t[grep("panel", figure_1$layout$name)]
figure_1$heights[panels][1] <- unit(0.7,'null')
figure_1$heights[panels][2] <- unit(12,'null')
#grid.draw(figure_1)
ggsave(file="test_landscape_ZCCHC7_locus.pdf", plot=figure_1,bg = 'white', width = 10, height = 12, units = 'cm', dpi = 600)
tableA <- new_table[which(new_table$Pos >= 37026028 & new_table$Pos <= 37026029),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0.1,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part1 <- F1b.pLot
tableA <- new_table[which(new_table$Pos >= 37026705 & new_table$Pos <= 37026706),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part2 <- F1b.pLot
tableA <- new_table[which(new_table$Pos >= 37026315 & new_table$Pos <= 37026316),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part3 <- F1b.pLot
tableA <- new_table[which(new_table$Pos >= 37026680 & new_table$Pos <= 37026681),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,0,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_blank(),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part4 <- F1b.pLot
tableA <- new_table[which(new_table$Pos >= 37026733 & new_table$Pos <= 37026734),]
F1b.pLot<-ggplot()+theme_classic()
F1b.pLot<-F1b.pLot+geom_tile(data = tableA,aes(x=reorder(sample,Xrank),y=reorder(paste0("chr9:",Pos),Yrank),fill=sub),color='black',width=1,height=1,size=0.4,stat='identity')
F1b.pLot<-F1b.pLot+theme(panel.background=element_rect(fill='transparent',color='transparent',size=1.3),plot.margin=unit(c(0,1,1,1),'lines'),plot.title=element_text(size=24,vjust=0.5,hjust=0.5,face='bold.italic'),
text=element_text(size=24,vjust=1.4,hjust=0.5,face='bold'),legend.key.width=unit(0.6,'cm'),legend.key.height=unit(0.68,'cm'),legend.position='none',axis.line.x = element_blank(),axis.line.y = element_blank(),
legend.direction='horizontal',legend.text=element_text(size=16,face='bold.italic'), axis.text.y=element_text(size=12,face='plain',vjust=0.5,hjust=1,color='black'),axis.ticks.y = element_blank(),axis.ticks.x = element_blank(),
axis.text.x=element_text(size=12,angle=90,vjust=0.5,hjust=1,face='plain',color='black'),axis.title.x=element_text(size=24,vjust=0,hjust=0.5,face='bold',color='black'),axis.title.y=element_text(size=24,hjust=0.5,vjust=2,face='bold',color='transparent'))
F1b.pLot<-F1b.pLot+scale_x_discrete(position = "bottom")+xlab(NULL)+ylab(NULL)
F1b.pLot<-F1b.pLot+scale_fill_manual(name=NULL,values =c(CT='#66c2a5',CG='#fc8d62' ,Del="#8da0cb",N="white"))
F1b.pLot
Part5 <- F1b.pLot
figure<-cbind(rbind(ggplotGrob(F2a.pLot),ggplotGrob(Part1),ggplotGrob(Part3),ggplotGrob(Part4),ggplotGrob(Part2),ggplotGrob(Part5)),size="last")
panels <- figure$layout$t[grep("panel", figure$layout$name)]
figure$heights[panels][1] <- unit(0.7,'null')
figure$heights[panels][2] <- unit(2,'null')
figure$heights[panels][3] <- unit(2,'null')
figure$heights[panels][4] <- unit(2,'null')
figure$heights[panels][5] <- unit(2,'null')
figure$heights[panels][6] <- unit(2,'null')
#grid.draw(figure_1)
ggsave(file="test_landscape_WGS_supported_TSS2_hotspotMut_in_GCB_tumors.pdf", plot=figure,bg = 'white', width = 9.5, height = 9, units = 'cm', dpi = 600)
